<html>
<head>
<title>Syzygy: How to Configure Your System</title>
</head>
<body bgcolor="#ffffff">
<a href="index.html">Documentation Index</a>
<p><font size="+2">Syzygy: How to Configure Your System</font>

<p>This chapter will show you how to configure Syzygy to work with your
equipment. First, and most importantly, you need to understand how Syzygy
stores its configuration information, the commands used to make that
information available to the Phleet (dbatch and dset), and the format(s) of
the files that can store large collections of configuration information.
After you understand, parameter database <a href="#Dbatch">basics</a>, you 
can learn specifically about three important categories of patameters:
<a href="#Graphics">graphics</a>, <a href="#DataAccess">data access</a>,
and <a href="#InputDevice">input devices</a>. Subsequent sections detail
how to set up a variety of environments, both for testing and production use.

<p><ul>
<li><a href="#Dbatch">Phleet Parameter Database Basics</a>
<li><a href="#Examples">Example Parameter Files</a>
<li><a href="#Graphics">Graphics: Parameter Explanation</a>
<li><a href="#DataAccess">Data Access: Parameter Explanation</a>
<li><a href="#InputDevice">Input Devices: Parameter Explanation</a>
<li><a href="#StandaloneVirtualCube">Standalone mode: A Virtual Cube</a>
<li><a href="#PassiveStereo">Passive Stereo</a>
<li><a href="#StandalonePassive">Standalone mode: Easy Demo Passive Display</a>
<li><a href="#Immersive">Immersive (fixed-wall) Virtual Environments</a>
<li><a href="#HMD">Head-Mounted Displays</a>
<li><a href="#MultiScreen">Multiple Screens on a Single Computer</a>
<li><a href="#OffNetwork">Running Syzygy Applications in Phleet Mode When Off the Network</a>  
</ul>

<a name="Dbatch">
<p><font size=+2>Phleet Parameter Database Basics</font>
</a>

<p>When running in standalone mode, a Syzygy program looks, by default, in
its current working directory for a file szg_parameters.txt that contains
configuration information. The format of this file is the same as is accepted
by the dbatch command.

<p>When running in Phleet mode, a Syzygy program queries the szgserver for
parameter information. The szgserver maintains a parameter database for each 
Phleet user, but when the szgserver starts up, it contains no parameter 
information at all. The user needs to, somehow, transmit that information to 
the szgserver, where it is stored while that program continues to run. The
user can make small adjustments to the parameter database using dset and
bulk adjustments by using dbatch.

<p>There are two types of parameters in the Phleet database, local and global.
Local parameters give information that is particular to a given computer, and
their database key is, essentially, a concatenation of their computer name,
parameter group, and parameter name. Consider the local parameter giving the
virtual world dimensions of graphics screen 0 on the computer smoke
(as it would appear in a dbatch file):

<pre>
  smoke SZG_SCREEN0 screen_dim 10/10
</pre>

In this case, the local parameter has key:

<pre>
  smoke/SZG_SCREEN0/screen_dim
</pre>

and value:

<pre>
  10/10
</pre>

<p>Global parameters are used to store information that is not tied to a
particular computer in the Phleet, for instance, a PForth program for
transforming input data or an input node configuration. An input node
configuration might appear like so in a dbatch file:

<pre>
  &lt;param&gt;
  &lt;name&gt; cube_tracker &lt;/name&gt;
  &lt;value&gt;
    &lt;szg_device&gt;
      &lt;input_sources&gt; arMotionstarDriver &lt;/input_sources&gt;
      &lt;input_sinks&gt;&lt;/input_sinks&gt;
      &lt;input_filters&gt; arTrackCalFilter &lt;/input_filters&gt;
      &lt;pforth&gt;
	  matrix inputMatrix
	  matrix outputMatrix
	  matrix correctXRotMatrix
	  matrix correctYRotMatrix
	  matrix correctZRotMatrix
	  matrix correctHeadRotMatrix
	  -30 0 correctXRotMatrix rotationMatrix
	  6 1 correctYRotMatrix rotationMatrix
	  -1 2 correctZRotMatrix rotationMatrix
	  correctYRotMatrix correctZRotMatrix correctHeadRotMatrix matrixMultiply
	  define filter_matrix_0
	    inputMatrix getCurrentEventMatrix
	    inputMatrix correctHeadRotMatrix outputMatrix matrixMultiply
	    outputMatrix setCurrentEventMatrix
	  enddef
      &lt;/pforth&gt;
    &lt;/szg_device&gt;
  &lt;/value&gt;
  &lt;/param&gt;
</pre>

The database key in this case is "cube_tracker" and the value is the
string containing the szg_device XML record.

<p>To set a single local parameter:

<pre>
  dset smoke SZG_SCREEN0 screen_dim 10/10
</pre>

<p>To set a single global parameter:

<pre>
  dset global_parameter_name global_parameter_value
</pre>

<p>To get large groups of parameters into the Phleet at once, use the
dbatch command. This takes a specified file and sends all the parameter
information encoded therein to the Phleet.

<pre>
  dbatch my_parameter_file
</pre>

<p>There are two formats for dbatch files (and szg_parameters.txt). The
first consists of a sequence of local parameter settings, interspersed
with comments. This "simple" style dbatch file is useful for quick 
experimentation and is less verbose than the "complex" style described
later. 

<pre>
# The "simple" style of dbatch file contains comments like so.
  cavefront SZG_SCREEN0 size              0/0
  cavefront SZG_SCREEN0 screen_center     0/5/-5
  cavefront SZG_SCREEN0 screen_dim        10/10
  cavefront SZG_SCREEN0 screen_normal     0/0/-1
  cavefront SZG_SCREEN0 screen_up         0/1/0
  cavefront SZG_SCREEN0 stereo            true
</pre>

Please note that each line must contain exactly 4 tokens, making this
format unsuitable for more complex constructions, like input node
configuration. 

<p>Consequently, there is another "complex", dbatch file format, which
is in XML. One of these files contains 3 types of XML records, "comment",
"assign", and "param". These records cannot be nested. For instance,
a "comment" block cannot appear within an "assign". They can, however,
appear in any order in the "complex" dbatch file, and there can be any number
of them.

<p>The "comment" record is just what it says. These are discarded by the
parser. The "assign" record holds data like in a "simple" dbatch file,
but without the "simple" style comments (those are illegal here). Finally,
the "param" record is used to encode Phleet global parameters. The following
is a sample "complex" dbatch file.

<pre>
  &lt;szg_config&gt;

  &lt;comment&gt; 
  This is what comments look like in a "complex" dbatch file.
  &lt;/comment&gt;

  &lt;assign
  cavefront SZG_SCREEN0 size              0/0
  cavefront SZG_SCREEN0 screen_center     0/5/-5
  cavefront SZG_SCREEN0 screen_dim        10/10
  cavefront SZG_SCREEN0 screen_normal     0/0/-1
  cavefront SZG_SCREEN0 screen_up         0/1/0
  cavefront SZG_SCREEN0 stereo            true
  &lt;/assign&gt;

  &lt;param&gt;
  &lt;name&gt; windows_joystick_filter &lt;/name&gt;
  &lt;value&gt;
    define filter_axis_0
      getCurrentEventAxis 0.000031 * setCurrentEventAxis
    enddef
    define filter_axis_1
      getCurrentEventAxis -0.000031 * setCurrentEventAxis
    enddef
  &lt;/value&gt;
  &lt;/param&gt;

  &lt;/szg_config&gt;
</pre>

<a name="Examples">
<p><font size=+2>Example Parameter Files</font>
</a>

<p>Here are templates for the main parameter files at use in the Integrated 
Systems Lab. For each template, a valid configuration file for a particular
user is generated by substituting his lab user name for "THE_USER_NAME", like
so:

<pre>
  sed 's/THE_USER_NAME/schaeffr/g' cube.txt > cube-schaeffr.txt
</pre>

<p>The file <a href="cube.txt">cube.txt</a> gives a template parameter
file for a 6-sided fixed screen VR environment (virtual computer=cube). 
It also demonstrates how different virtual computers (cube and wincube) can 
share the same virtual computer location (cube).

<p>The file <a href="lab.txt">lab.txt</a> gives a template parameter 
file for a lab containing a group of workstations, a dual-headed passive stereo
display (virtual computer=passive), an Immersadesk-style active stereo display
(virtual computer=idesk), and a 3x2 video wall (virtual computer=wall).

<p>The file <a href="cave.txt">cave.txt</a> gives a template parameter file
for a 4-sided fixed screen VR environment (virtual computer=cave).

<a name="Graphics">
<p><font size=+2>Graphics: Parameter Explanation</font>
</a>

<p>In this section, we first explain the basic way to configure a graphics 
screen. Next, we tackle advanced options like the special Syzygy demo mode 
which sacrifices projection accuracy to
accomodate large groups in an immersive virtual environment, how to enable
framelocking for supported graphics cards, and how to configure multiple 
graphics passes in a single window to produce a variety of effects.
For the sake of clarity, we use parameter group SZG_SCREEN0 but it could
just as easily be SZG_SCREEN1, SZG_SCREEN2, etc.

<p>The various SZG_SCREEN(n)'s require some explanation. First of all,
Syzygy supports multiple screens per computer (in seperate windows). Secondly,
Syzygy supports having multiple viewports per graphics window. By default,
the SZG_SCREEN0 parameters are used, but command line arguments (as in the
<a href="PhleetIntro.html#Context">context</a>) can change that. When a
virtual computer launches an application with 
<a href="#MultiScreen">multiple windows</a> on a single computer, it will
use a different SZG_SCREEN(n) for each screen. 

<pre>
  SZG_SCREEN0 size x/y

   If x=0 and y=0, this creates a full screen window. Otherwise, x and
   y give the appropriate window dimensions. If not set, the default
   is 640/480.

  SZG_SCREEN0 position x/y

   The x/y screen coordinates of the window origin. Default is 0/0.

  SZG_SCREEN0 tile A/B/C/D

   Used for working with tiled display walls. There are B horizontal tile
   and D vertical tiles. This particular tile is the (A)th horizontal one,
   with numbering starting at 0 and the display's left. The tile is the
   (B)th vertical one, with numbering starting at 0 and the display's
   bottom. Default is 0/1/0/1 (i.e. no tiling).

  SZG_SCREEN0 screen_center x/y/z

   Screen center in physical coordinates (feet). Default is 0/5/-5.

  SZG_SCREEN0 screen_dim x/y
  
   Screen dimensions in feet. Default is 10/10.

  SZG_SCREEN0 screen_normal x/y/z

   Outward pointing screen normal (away from the viewer), expressed in
   physical coordinates. Default is 0/0/-1.

  SZG_SCREEN0 screen_up x/y/z

   Up direction in physical coordinates. This can be used to correct for
   projector rotation. Default is 0/1/0.

  SZG_SCREEN0 stereo [true, false]

   Whether or not the screen should be drawn using active stereo. This 
   requires LCD stereo shutter goggles and a graphics card that supports 
   OpenGL stereo buffers. This parameter must be either "true" or "false", 
   with the default being "false". The Syzygy application frameworks query the 
   graphics card regarding stereo buffer support; if it is not supported, this 
   parameter is ignored.

  SZG_SCREEN0 default_eye [none,right, left]

   Normally, a nonstereo screen is displayed using a viewpoint
   midway between the two eyes. However, if this parameter is set,
   a viewpoint from either the right or the left eye can be selected.
   This is useful for building a passive stereo display system using
   2 computers, each displaying a seperate channel. Defaults to "none".
</pre>

<p>Proper projections for fixed screen VR are really just for one person.
The further away a secondary observer is from the tracked viewpoint, the more
distorted things look. Furthermore, the eye seperation or drawing order on
a screen might be very wrong for an observer if his head is oriented 
differently than the tracked viewpoint. Consequently, Syzygy has a "demo mode"
which sacrifices accuracy of projection (there will be misalignment at 
screen junctions) in exchange for presenting as sensible as possible of a
stereo view for everyone in a group on people wandering around and looking
in all different directions simultaneously.

<pre>
  SZG_SCREEN0 fixed_head [true, false]

   Whether or not the screen is using fixed-head mode. In fixed-head mode, 
   the projection is determined based on a fixed head position and orientation.
   The orientation depends on the screen_normal. Fixed-head mode is better than
   the correct VR projection for a large group of people inside a 
   projection-based virtual environment. The default is "false". The actual 
   fixed position is taken from SZG_SCREEN0/fixed_head_pos.

  SZG_SCREEN0 fixed_head_pos x/y/z

   The fixed head position, in physical coordinates, that will be used if 
   fixed-head mode is enabled. The default is 0/5/0.

  SZG_SCREEN0 fixed_head_up_angle x

   In fixed-head mode, the viewing head is oriented so that it is pointing
   directly towards the screen (as determined by screen_normal). Note that 
   this leaves one degree of rotational ambiguity. This parameter (expressed 
   in degrees) can be used to manipulate this. Default is 0.
</pre>

<p>Syzygy supports the framelocking feature on Wildcat graphics cards. Since
this should only be enabled for cards set up to framelock together (there
are special cables to be connected between the cards), its use needs to be
requested by a parameter.

<pre>
  SZG_SCREEN0 wildcat_framelock [true, false]

   If a wildcat board is present, should framelocking be enabled?
   Default is "false".
</pre>

<p>Several forms of stereo (mostly passive as opposed to active) rely
on drawing two different views of a scene in a single graphics window. Syzygy
supports these stereo methods, however, please be advised that you should
have:

<pre>
  my_display_computer SZG_SCREEN0 stereo false
</pre>

To take advantage of them. The Syzygy "stereo" parameter refers to 
<em>active</em> stereo only!

<p>These viewing modes are given by the following parameter. There are
several ones built-in, along with a means ("custom") of defining your own.

<pre>  
  SZG_SCREEN0 view_mode [normal,anaglyph,walleyed,crosseyed,overunder,custom]
</pre>

<p><ol>
<li>normal: This is the default. If active stereo is disabled, the scene
is rendered once for the default view position (see default_eye, above), 
taking up the entire window. If active stereo is enabled, it's rendered into 
the left buffer from the left-eye viewpoint, etc.
     
<li>anaglyph: The left-eye view is rendered into the red channel
and the right-eye view is rendered into the green and blue
channels, for viewing with red/green or red/blue glasses. Note that
this only works well if the scene itself does not contain color
information, or if large patches of color are restricted to the plane of 
the screen.
     
<li>walleyed: The window is split in half, with the left-eye view
in the left half and the right-eye view in the right half. This
arrangement can be viewed with mirrors, or if the window is small,
by diverging the eyes as for single-image stereograms. With a
dual-head graphics card, the user can configure the desktop so that
one output displays the left half and the displays the right half.
     
<li>crosseyed: As above, but the left-eye image is on the right,
and vice-versa. To be viewed by crossing the eyes.
     
<li>overunder: The left-eye view is in the bottom half and the
right-eye view is on top. For use with over/under stereo viewers
like the View Magic (google it).
</ol>

<p>We now give an explanation of the "custom" view mode, which is intended
to handle exotic configurations not covered by the presets. When a window
is configured using SZG_SCREEN0 (for instance) and view_mode is "custom",
it checks viewport_list to find out what screen configuration variables
should be used in defining the other viewports (there is a slash delimited
list). Each viewport then has three parameters indicating how it is 
displayed:

<pre>
  SZG_SCREEN0 viewport_dim lower_left_x/lower_left_y/width_x/width_y

   The viewport's coordinates are given as window size relative floating
   point numbers. The lower left corner of the window has coordinates
   (0,0) and the upper right corner has coordinates (1,1). The width and
   height of the window are both considered to be 1. The parameter value
   defaults to 0/0/1/1.

  SZG_SCREEN0 color_mask true/false/false/true

   This determines what OpenGL color mask will be applied to the window,
   as is necessary for doing anaglyph type stereo. The color mask values
   are given in RGBA order, and must be either "true" or "false". In the
   example here, only the red value of the scene's pixels will be drawn.
   The default is "true/true/true/true", which draws the scene normally.

  SZG_SCREEN0 depth_clear false

   When mutliple passes of the same scene are drawn on the same piece of
   screen real estate (as in anaglyph stereo), the second pass must clear
   the depth buffer before drawing. If this parameter is set to "true",
   the depth buffer will be cleared before drawing, otherwise it will
   not. The default is "false".
</pre>

<p>This can be used to configure a screen for computer "smoke" with
three viewports, giving the left, center, and right walls of an immersive
virtual environment. This is in "simple" dbatch file format.

<pre>
  smoke SZG_SCREEN0 view_mode custom
  smoke SZG_SCREEN0 screen_center     -5/5/0
  smoke SZG_SCREEN0 screen_dim        10/10
  smoke SZG_SCREEN0 screen_normal     -1/0/0
  smoke SZG_SCREEN0 screen_up         0/1/0
  smoke SZG_SCREEN0 viewport_list SZG_SCREEN1/SZG_SCREEN2
  smoke SZG_SCREEN0 viewport_dim 0/0/0.3333/1
  smoke SZG_SCREEN0 eye_sign 0
  smoke SZG_SCREEN0 color_mask true/true/true/true
  smoke SZG_SCREEN0 depth_clear false

  smoke SZG_SCREEN1 screen_center     0/5/-5
  smoke SZG_SCREEN1 screen_dim        10/10
  smoke SZG_SCREEN1 screen_normal     0/0/-1
  smoke SZG_SCREEN1 screen_up         0/1/0
  smoke SZG_SCREEN1 viewport_dim 0.3333/0/0.3333/1
  smoke SZG_SCREEN1 eye_sign 0
  smoke SZG_SCREEN1 color_mask true/true/true/true
  smoke SZG_SCREEN1 depth_clear false

  smoke SZG_SCREEN2 screen_center     5/5/0
  smoke SZG_SCREEN2 screen_dim        10/10
  smoke SZG_SCREEN2 screen_normal     1/0/0
  smoke SZG_SCREEN2 screen_up         0/1/0
  smoke SZG_SCREEN2 viewport_dim 0.6666/0/0.3333/1
  smoke SZG_SCREEN2 eye_sign 0
  smoke SZG_SCREEN2 color_mask true/true/true/true
  smoke SZG_SCREEN2 depth_clear false
</pre>


<a name="DataAccess">
<p><font size=+2>Data Access: Parameter Explanation</font>
</a>

<p>The various paths the system uses to find executables, loadable libraries,
textures, sound clips, and other data are now explained. These values of these
parameters will often be the main variations in the databases of different
users. Because Windows file names can use
colons, we ensure portability by using semi-colon delimited lists to give the 
paths. For simplicity, we omit the computer name from these parameter examples.
To use them in a dbatch file, you would have to include it.

<pre>
  SZG_EXEC path directory_1;directory_2

   Location of the executables for a given user.

  SZG_NATIVELIB path directory_1

   Location of dynamic libraries for a given user.

  SZG_PYTHON path directory_1;directory_2

   The directories in which the python "application bundles" live.

  SZG_PYTHON lib_path directory_1;directory_2;directory_3

   The directories where extra Python loadable modules exist.

  SZG_DATA path directory_1

   Location of data.

  SZG_SOUND path directory_1;directory_2;directory_3

   Location of sound files loaded by SoundRender.

  SZG_RENDER texture_path directory_1

   Location of texture files loaded by szgrender.

  SZG_RENDER text_path directory_1

   Location of textured text font used by szgrender billboard.
</pre>

<a name="InputDevice">
<p><font size=+2>Input Devices: Parameter Explanation</font>
</a>

<p>Many input devices need special configuration, like specifying the serial
port it uses or the mode in which it should operate. The 
<a href="InputDevices-drivers.html">chapter</a> on supported input
devices describes any specific parameters that must be configured to operate
a particular device.

<p>Two general kinds of configuration apply to all input devices. First, 
<a href="PForth.html">PForth</a> programs can operate on input data streams,
doing tasks like rescaling input event values or rearranging event IDs.

<p>With joysticks and/or gamepads this functionality is critical for providing 
cross platform or even cross device support on a single platform. Joystick axes 
on Linux typically report 0 to 64k, whereas joystick axes of Windows 
might report either [-32k,32k] or [0,64k]. Furthermore, 
a given gamepad may, on different systems,
have its axes numbered differently, and, more fundamentally, since no standard
for gamepad design exists, the numbering given by the OS might not agree with
the numbering we want for our interface. Additionally, the Syzygy VR framework
applications expect a standard joystick type input, with axis 0 corresponding
to the horizontal, axis1 corresponding to the vertical, both normalized to the
range [-1,1], and the value (-1,-1) realized in the lower left corner. As
a consequence of these constraints, some data filtration is required between
the raw information reported by the input device and its use in a Syzygy
application.

<p>While general transformations of the input event stream are handled by
loadable modules derived from arIOFilter, PForth programs are ideally suited
to the event processing necessary for joystick/gamepad standardization, as well
as being able to handle some simple tracker calibration tasks. Below, we give
an example PForth program as it might appear in a "complex" dbatch file.

<pre>
&lt;param&gt;
  &lt;name&gt; joystick_test &lt;/name&gt;
  &lt;value&gt;
    define filter_axis_0
      getCurrentEventAxis 0.000031 * setCurrentEventAxis
    enddef
    define filter_axis_1
      getCurrentEventAxis -0.000031 * setCurrentEventAxis
    enddef
  &lt;/value&gt;
&lt;/param&gt;
</pre>

<p>This program (appropriate for a particular gamepad on Windows) and takes events 
coming from axis 0 and scales them to the [-1,1] range. It also scales events from
axis 1 into that same range, reversing their sign in the process. After the 
global parameter "joystick_test" giving this PForth program is loaded into the
parameter database, you can run the following programs in Phleet mode to see the
results. Note that your joystick would actually need to be connected to the
computer on which you run DeviceServer. In contrast, DeviceClient can be run
anywhere else in the Phleet (though on each computer you will have to be dlogin'ed
as the same Phleet user).

<pre>
  DeviceServer -s arJoystickDriver 0 joystick_test
  
  DeviceClient 0
</pre>

<p>DeviceClient should begin printing out values from the joystick. You can experiment
with changing the PForth program to see how that affects the output. For instance, if
you wanted to offset the values so that they were in the range [0,2], the following
modified program would work (note that PForth is stack-based, so operation order
resembles reverse Polish notation):

<pre>
&lt;param&gt;
  &lt;name&gt; joystick_test2 &lt;/name&gt;
  &lt;value&gt;
    define filter_axis_0
      getCurrentEventAxis 0.000031 * 1 + setCurrentEventAxis
    enddef
    define filter_axis_1
      getCurrentEventAxis -0.000031 * 1 + setCurrentEventAxis
    enddef
  &lt;/value&gt;
&lt;/param&gt;
</pre>

<p>Sometimes DeviceServer needs special configuration beyond what can be provided
directly from the command line. In this case, a global parameter will store the
DeviceServer configuration. This includes information on what input sinks and 
sources will be deployed, what loadable IO filters will be used, along with
a PForth program that will operate on the events, if any. An example follows,
as it would appear in a "complex" dbatch file:

<pre>
&lt;param&gt;
&lt;name&gt; cube_tracker &lt;/name&gt;
&lt;value&gt;
  &lt;szg_device&gt;
    &lt;input_sources&gt; arMotionstarDriver &lt;/input_sources&gt;
    &lt;input_sinks&gt;&lt;/input_sinks&gt;
    &lt;input_filters&gt; arTrackCalFilter &lt;/input_filters&gt;
    &lt;pforth&gt;
	matrix inputMatrix
	matrix outputMatrix
	matrix correctXRotMatrix
	matrix correctYRotMatrix
	matrix correctZRotMatrix
	matrix correctHeadRotMatrix
	-30 0 correctXRotMatrix rotationMatrix
	6 1 correctYRotMatrix rotationMatrix
	-1 2 correctZRotMatrix rotationMatrix
	correctYRotMatrix correctZRotMatrix correctHeadRotMatrix matrixMultiply
	define filter_matrix_0
	  inputMatrix getCurrentEventMatrix
	  inputMatrix correctHeadRotMatrix outputMatrix matrixMultiply
	  outputMatrix setCurrentEventMatrix
	enddef
    &lt;/pforth&gt;
  &lt;/szg_device&gt;
&lt;/value&gt;
&lt;/param&gt;
</pre>

<p>This example shows how PForth programs can be used for tracker calibration tasks, and
it would be activated by:

<pre>
  DeviceServer cube_tracker 0
</pre>

<p>Please read the chapter on <a href="inputDevices.html">input devices</a> for
more information on how to use the DeviceServer and DeviceClient programs.

<a name="StandaloneVirtualCube">
<p><font size=+2>Standalone mode: A Virtual Cube</font>
</a>

<p>Sometimes, for debugging purposes, it might be convenient to be able to see, in
a single window, most of the screens (in this case 5 out of 6) in an immersive
virtual environment. This lets us make sure that are camera projection code is
doing the right thing with minimal hassle and also gives an interesting
visual effect. The string "NULL" in place of a computer name is interpreted as
a wildcard, indicating the current computer, whatever that is. This can be
allows the standalone dbatch files to be moved from computer to computer.
The following parameters can be placed directly in a "simple" dbatch file
or including in an "assign" record in a "complex" dbatch file.

<pre>
  NULL SZG_SCREEN0 view_mode custom
  NULL SZG_SCREEN0 screen_center     0/5/-5
  NULL SZG_SCREEN0 screen_dim        10/10
  NULL SZG_SCREEN0 screen_normal     0/0/-1
  NULL SZG_SCREEN0 screen_up         0/1/0
  NULL SZG_SCREEN0 viewport_list SZG_SCREEN1/SZG_SCREEN2/SZG_SCREEN3/SZG_SCREEN4
  NULL SZG_SCREEN0 viewport_dim 0.3333/0.3333/0.3333/0.3333
  NULL SZG_SCREEN0 eye_sign 0
  NULL SZG_SCREEN0 color_mask true/true/true/true
  NULL SZG_SCREEN0 depth_clear false

  NULL SZG_SCREEN1 screen_center     0/10/0
  NULL SZG_SCREEN1 screen_dim        10/10
  NULL SZG_SCREEN1 screen_normal     0/1/0
  NULL SZG_SCREEN1 screen_up         0/0/1
  NULL SZG_SCREEN1 viewport_dim 0.3333/0.6666/0.3333/0.3333
  NULL SZG_SCREEN1 eye_sign 0
  NULL SZG_SCREEN1 color_mask true/true/true/true
  NULL SZG_SCREEN1 depth_clear false

  NULL SZG_SCREEN2 screen_center     0/0/0
  NULL SZG_SCREEN2 screen_dim        10/10
  NULL SZG_SCREEN2 screen_normal     0/-1/0
  NULL SZG_SCREEN2 screen_up         0/0/-1
  NULL SZG_SCREEN2 viewport_dim 0.3333/0/0.3333/0.3333
  NULL SZG_SCREEN2 eye_sign 0
  NULL SZG_SCREEN2 color_mask true/true/true/true
  NULL SZG_SCREEN2 depth_clear false

  NULL SZG_SCREEN3 screen_center     5/5/0
  NULL SZG_SCREEN3 screen_dim        10/10
  NULL SZG_SCREEN3 screen_normal     1/0/0
  NULL SZG_SCREEN3 screen_up         0/1/0
  NULL SZG_SCREEN3 viewport_dim 0.6666/0.3333/0.3333/0.3333
  NULL SZG_SCREEN3 eye_sign 0
  NULL SZG_SCREEN3 color_mask true/true/true/true
  NULL SZG_SCREEN3 depth_clear false

  NULL SZG_SCREEN4 screen_center     -5/5/0
  NULL SZG_SCREEN4 screen_dim        10/10
  NULL SZG_SCREEN4 screen_normal     -1/0/0
  NULL SZG_SCREEN4 screen_up         0/1/0
  NULL SZG_SCREEN4 viewport_dim 0/0.3333/0.3333/0.3333
  NULL SZG_SCREEN4 eye_sign 0
  NULL SZG_SCREEN4 color_mask true/true/true/true
  NULL SZG_SCREEN4 depth_clear false
</pre>

<a name="PassiveStereo">
<p><font size=+2>Passive Stereo</font>
</a>

<p>Syzygy supports a variety of passive stereo configurations. One of them, "walleyed",
is suited to working with dual-headed graphics cards under Windows. Many of these cards
can be set up so that the Windows desktop extends across both monitors and a single
hardware accelerated OpenGL window can cover the whole thing. Under this scenario,
a full screen window, with a left eye view on one half and the right eye view on the
other half, can provide passive stereo. Simply hook up projectors to each of the card's
outputs, put polarizing filters on each, and project onto the same screen. You can
then use cheap stereo glasses (based on polarized light) 
to see the visualization in 3D. The following configuration shows how to do this
for screen 0 of the computer "smoke". 
NOTE: "stereo" is "false" because "stereo" means active stereo under Syzygy! Also,
setting the window size to "0/0" means full screen.

<pre>
  smoke SZG_SCREEN0 size 0/0
  smoke SZG_SCREEN0 view_mode walleyed
  smoke SZG_SCREEN0 stereo false
</pre>

<a name="StandalonePassive">
<p><font size=+2>Standalone Mode: Easy Demo Passive Display</font>
</a>

<p>Since passive stereo displays are so easy to set up and so cheap, given how common
dual headed video game graphics cards are, they are ideal for travelling demos, like
one might bring to a conference or trade show. One consideration with demo system design
is tracking, since, in the interests of simplicity, one would like to avoid it all
together. Tracking can be of marginal benefit in such situations.

<p>Consequently, a simple demo system might skip tracking altogether in favor of gamepad
control. Syzygy VR framework applications often assume their input device provides them
with a matrix giving head position and orientation (matrix 0) and a matrix giving
wand (manipulation device) position and orientation (matrix 1). Navigation in the world
is accomplished by a combination of wand matrix plus button pushes and axis manipulation.
In many cases, leaving the wand matrix in a default (identity matrix) position still
allows for sufficient navigation for a successdul demo. However, the head matrix often
needs to go into a non-default position (not (0,0,0)) to have things appear sensibly on
screen.

<p>To fix this problem, we construct a PForth filter that, when processing an event from
the gamepad, creates an additional (and spurious) head matrix event, putting the head
in the desired default position.

<p>The following dbatch file ("complex" format) gives a standalone mode
configuration for a demo system as described above. Note that the lone
global parameter gives a PForth program instead of a full input node configuration.
In standalone mode, Syzygy VR framework applications either use an embedded
wandsimserver to generate input events or rely on joystick input. The value of
SZG_DEMO/control_mode (either "joystick" or "normal", which is the default)
determines the control scheme used. Also, SZG_PFORTH/program_names gives the
name of the global parameter holding the PForth program to be applied, if any.

<p>The "joystick" PForth program listed, of course, pertains to a particular
gamepad. However, it does illustrate how to switch axes around. For instance,
it addition to rescaling, axis 2 is mapped to axis 3 and axis 5 is mapped to
axis 2.

<pre>
  &lt;szg_config&gt;
  &lt;param&gt;
    &lt;name&gt; joystick &lt;/name&gt;
    &lt;value&gt;
      matrix temp
      0 5 0 temp translationMatrix
      define filter_axis_0
        getCurrentEventAxis 0.000031 * setCurrentEventAxis
      enddef
      define filter_axis_1
        temp 0 insertMatrixEvent
        getCurrentEventAxis -0.000031 * setCurrentEventAxis
      enddef
      define filter_axis_2
        getCurrentEventAxis -32768 + -0.000031 *
        deleteCurrentEvent
        3
        insertAxisEvent
      enddef
      define filter_axis_5
        getCurrentEventAxis -32768 + 0.000031 *
        deleteCurrentEvent
        2
        insertAxisEvent
      enddef
    &lt;/value&gt;
  &lt;/param&gt;

  &lt;assign&gt;
  NULL SZG_DATA path ./
  NULL SZG_DEMO control_mode joystick
  NULL SZG_PFORTH program_names joystick
  NULL SZG_SCREEN0 view_mode walleyed
  NULL SZG_SCREEN0 size 0/0
  NULL SZG_SCREEN0 screen_center     0/5/-5
  NULL SZG_SCREEN0 screen_dim        13.333/10
  NULL SZG_SCREEN0 screen_normal     0/0/-1
  NULL SZG_SCREEN0 screen_up         0/1/0
  &lt;/assign&gt;
</pre>

<a name="Immersive">
<p><font size=+2>Immersive (fixed-wall) Virtual Environments</font>
</a>

<p>An early supported Syzygy configuration was one stereo window per PC, with each
window supporting one wall of an immersive virtual environment. The following
text shows screen definitions (plus a virtual computer employing them) for
a six walled virtual environment. It can either be put, as is, into a "simple"
format dbatch file or it can go into an "assign" record in a "complex"
dbatch file.

<pre>
  cube SZG_CONF    location       cube
  cube SZG_CONF    virtual        true
  cube SZG_TRIGGER map            air
  cube SZG_MASTER  map            SZG_SCREEN2
  cube SZG_SCREEN  number_screens 6
  cube SZG_SCREEN0 map            top/SZG_SCREEN0
  cube SZG_SCREEN0 networks       internet
  cube SZG_SCREEN1 map            bottom/SZG_SCREEN0
  cube SZG_SCREEN1 networks       internet
  cube SZG_SCREEN2 map            north/SZG_SCREEN0
  cube SZG_SCREEN2 networks       internet
  cube SZG_SCREEN3 map            south/SZG_SCREEN0
  cube SZG_SCREEN3 networks       internet
  cube SZG_SCREEN4 map            east/SZG_SCREEN0
  cube SZG_SCREEN4 networks       internet
  cube SZG_SCREEN5 map            west/SZG_SCREEN0
  cube SZG_SCREEN5 networks       internet
  cube SZG_INPUT0  map            air/cube_tracker/joystick/cube_joystick
  cube SZG_INPUT0  networks       internet

  north SZG_SCREEN0 size              0/0
  north SZG_SCREEN0 screen_center     0/4.93/-4.93
  north SZG_SCREEN0 screen_dim        9.86/9.86
  north SZG_SCREEN0 screen_normal     0/0/-1
  north SZG_SCREEN0 screen_up         0/1/0
  north SZG_SCREEN0 stereo            true

  south SZG_SCREEN0 size              0/0
  south SZG_SCREEN0 screen_center     0/4.93/4.93
  south SZG_SCREEN0 screen_dim        9.86/9.86
  south SZG_SCREEN0 screen_normal     0/0/1
  south SZG_SCREEN0 screen_up         0/1/0
  south SZG_SCREEN0 stereo            true

  top SZG_SCREEN0 size                0/0
  top SZG_SCREEN0 screen_center       0/9.86/0
  top SZG_SCREEN0 screen_dim          9.86/9.86
  top SZG_SCREEN0 screen_normal       0/1/0
  top SZG_SCREEN0 screen_up           -1/0/0
  top SZG_SCREEN0 stereo              true

  bottom SZG_SCREEN0 size              0/0
  bottom SZG_SCREEN0 screen_center     0/0/0
  bottom SZG_SCREEN0 screen_dim        9.86/9.86
  bottom SZG_SCREEN0 screen_normal     0/-1/0
  bottom SZG_SCREEN0 screen_up         0/0/-1
  bottom SZG_SCREEN0 stereo            true

  east SZG_SCREEN0 size              0/0
  east SZG_SCREEN0 screen_center     4.93/4.93/0
  east SZG_SCREEN0 screen_dim        9.86/9.86
  east SZG_SCREEN0 screen_normal     1/0/0
  east SZG_SCREEN0 screen_up         0/1/0
  east SZG_SCREEN0 stereo            true

  west SZG_SCREEN0 size              0/0
  west SZG_SCREEN0 screen_center     -4.93/4.93/0
  west SZG_SCREEN0 screen_dim        9.86/9.86
  west SZG_SCREEN0 screen_normal     -1/0/0
  west SZG_SCREEN0 screen_up         0/1/0
  west SZG_SCREEN0 stereo            true
</pre>

<a name="HMD">
<p><font size=+2>Head-Mounted Displays</font>
</a>

<p>Syzygy's first application in Spring 2000 was a cluster-driven HMD, with a seperate
consumer PC driving each eye. This configuration is still supported, along with a single
PC set up, where two viewports in a single window give left eye and right eye views,
respectively.

<a name="MultiScreen">
<p><font size=+2>Multiple Screens on a Single Computer</font>
</a>

<p>Sometimes having multiple seperate graphics screens on a single computer is desirable.
For instance, in this way, you can run Syzygy applications on an SMP computer
(like the SGI Onyx series) with mutliple graphics cards. It also helps when testing whether
a Syzygy master/slave application will work properly on a cluster, but without having to
have a cluster available.

<p>Note that consumer level graphics cards, as a rule, do not do very well having multiple
OpenGL windows active simultaneously. Performance degrades significantly over the
equivalent standalone mode case where there are multiple viewports in a single window.
Indeed, on many common systems, just having a wandsimserver window open (which is a small
window with very simple OpenGL graphics) in addition to an application window severely
degrades application performance. This is actually why standalone mode was originally
invented: to deal with the limitations of Syzygy application development on very low
end hardware. 

<p>Of course, these performance conisderations DO NOT apply to the high end computers with
multiple graphics cards and processors that are designed to run these types of
applications (again like an SGI Onyx or, say, a 4-way Linux box with multiple graphics
cards).

<p>The following example, suitable for inclusion directly in a "simple" dbatch file, or
within an "assign" record in a "complex" dbatch file. It gives a virtual computer 
"smoke_test" which has four screens and uses a wandsimserver for an input device. These
screens give a 2x2 tiled display and are automatically placed in the proper arrangement upon
launch, through the SZG_SCREEN(n)/position parameter. Similarly, the wandsimserver is
placed to the right of everything, as given by the SZG_WANDSIM/position parameter.
Please note that the desktop in question is 1600x1200. A smaller desktop would need positions
and window sizes reduced.

<pre>
  smoke_test SZG_CONF virtual true
  smoke_test SZG_TRIGGER map smoke
  smoke_test SZG_MASTER map SZG_SCREEN0
  smoke_test SZG_SCREEN number_screens 4
  smoke_test SZG_SCREEN0 map smoke/SZG_SCREEN1
  smoke_test SZG_SCREEN1 map smoke/SZG_SCREEN2
  smoke_test SZG_SCREEN2 map smoke/SZG_SCREEN3
  smoke_test SZG_SCREEN3 map smoke/SZG_SCREEN4
  smoke_test SZG_INPUT0 map smoke/wandsimserver

  smoke SZG_WANDSIM position 1305/0

  smoke SZG_SCREEN1 size 640/480
  smoke SZG_SCREEN1 position 0/0
  smoke SZG_SCREEN1 tile 0/2/1/2
  smoke SZG_SCREEN1 screen_center 0/5/-5
  smoke SZG_SCREEN1 screen_dim 10/10
  smoke SZG_SCREEN1 screen_normal 0/0/-1
  smoke SZG_SCREEN1 screen_up 0/1/0

  smoke SZG_SCREEN2 size 640/480
  smoke SZG_SCREEN2 position 652/0
  smoke SZG_SCREEN2 tile 1/2/1/2
  smoke SZG_SCREEN2 screen_center 0/5/-5
  smoke SZG_SCREEN2 screen_dim 10/10
  smoke SZG_SCREEN2 screen_normal 0/0/-1
  smoke SZG_SCREEN2 screen_up 0/1/0

  smoke SZG_SCREEN3 size 640/480
  smoke SZG_SCREEN3 position 0/505
  smoke SZG_SCREEN3 tile 0/2/0/2
  smoke SZG_SCREEN3 screen_center 0/5/-5
  smoke SZG_SCREEN3 screen_dim 10/10
  smoke SZG_SCREEN3 screen_normal 0/0/-1
  smoke SZG_SCREEN3 screen_up 0/1/0

  smoke SZG_SCREEN4 size 640/480
  smoke SZG_SCREEN4 position 652/505
  smoke SZG_SCREEN4 tile 1/2/0/2
  smoke SZG_SCREEN4 screen_center 0/5/-5
  smoke SZG_SCREEN4 screen_dim 10/10
  smoke SZG_SCREEN4 screen_normal 0/0/-1
  smoke SZG_SCREEN4 screen_up 0/1/0
</pre>

<a name="OffNetwork">
<p><font size=+2>Running Syzygy Applications in Phleet Mode When Off the Network</font>
</a>

<p>Sometimes it is desirable to be able to run Syzygy applications off the
network. On nice way to do this is <a href="Standalone.html">standalone mode</a>.
However, sometimes you will want to run in Phleet mode (as you would on a cluster),
but only on a single computer. Since Phleet mode requires a network connection 
and your operating system might turn off NICs if they are not connected,
the solution is to use the loopback address (127.0.0.1).

<p>First, you will need to make sure that the phleet configuration file is
set up with the loopback address. Use
the "daddinterface" and "ddelinterface" commands, as outlined in the
<a href="PhleetIntro.html">introduction</a> to produce a configuration file
that has "dconfig" produce output like:

<pre>
  Phleet configuration
    computer = your_computer_name
    network = local, address = 127.0.0.1, netmask=255.255.255.0
    ports = 4700 - 4899
</pre>

<p>Next, run szgserver, as outlined in the 
<a href="PhleetIntro.html">introduction</a>. An example (the given port number is
arbitrary):

<pre>
  szgserver my_server_name 4999
</pre>

<p>Finally, you need to dlogin. Since the loopback interface filters broadcast
packets, you need to connect by IP/port instead of via server name.

<pre>
  dlogin 127.0.0.1 4999 syzygy_user_name
</pre>

<hr>

</body>
</html>
